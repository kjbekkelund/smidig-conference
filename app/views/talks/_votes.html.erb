<% if !current_user %>
<%= link_to "Log in to vote", new_user_session_url %>
<% elsif @talk.votes.find(:all, :conditions => { :user_id => current_user }).empty? %>
<%= link_to "Vote for this talk", talk_votes_url(@talk), :method => :post %>
<% else %>
You have voted for this talk
<% end %>
